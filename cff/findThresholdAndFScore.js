var old_samples = [
    {matches:150, object:29, subject:121, true_class:1},
    {matches:316, object:25, subject:291, true_class:1},
    {matches:175, object:3, subject:172, true_class:1},
    {matches:720, object:39, subject:681, true_class:1},
    {matches:42, object:24, subject:18, true_class:1},
    {matches:353, object:30, subject:323, true_class:1},
    {matches:197, object:69, subject:128, true_class:1},
    {matches:234, object:1, subject:233, true_class:1},
    {matches:67, object:46, subject:21, true_class:1},
    {matches:438, object:427, subject:11, true_class:1},
    {matches:34, object:0, subject:34, true_class:1},
    {matches:56, object:2, subject:54, true_class:1},
    {matches:65, object:44, subject:21, true_class:1},
    {matches:203, object:110, subject:93, true_class:1},
    {matches:50, object:36, subject:14, true_class:1},
    {matches:18, object:13, subject:5, true_class:1},
    {matches:117, object:9, subject:108, true_class:1},
    {matches:127, object:34, subject:93, true_class:1},
    {matches:50, object:16, subject:34, true_class:1},
    {matches:280, object:33, subject:247, true_class:1},
    {matches:272, object:7, subject:265, true_class:1},
    {matches:290, object:16, subject:274, true_class:1},
    {matches:986, object:73, subject:913, true_class:1},
    {matches:920, object:388, subject:532, true_class:1},
    {matches:286, object:0, subject:286, true_class:1},
    {matches:33, object:4, subject:29, true_class:1},
    {matches:1119, object:321, subject:798, true_class:1},
    {matches:256, object:161, subject:95, true_class:1},
    {matches:380, object:96, subject:284, true_class:1},
    {matches:78, object:57, subject:21, true_class:1},
    {matches:85, object:56, subject:29, true_class:1},
    {matches:199, object:8, subject:191, true_class:1},
    {matches:424, object:28, subject:396, true_class:1},
    {matches:693, object:137, subject:556, true_class:1},
    {matches:401, object:373, subject:28, true_class:1},
    {matches:483, object:28, subject:455, true_class:1},
    {matches:101, object:39, subject:62, true_class:1},
    {matches:40, object:16, subject:24, true_class:1},
    {matches:236, object:62, subject:174, true_class:1},
    {matches:36, object:12, subject:24, true_class:1},
    {matches:18, object:8, subject:10, true_class:1},
    {matches:103, object:39, subject:64, true_class:1},
    {matches:63, object:4, subject:59, true_class:1},
    {matches:146, object:11, subject:135, true_class:1},
    {matches:1489, object:532, subject:957, true_class:1},
    {matches:451, object:162, subject:289, true_class:1},
    {matches:459, object:42, subject:417, true_class:1},
    {matches:140, object:97, subject:43, true_class:1},
    {matches:158, object:77, subject:81, true_class:1},
    {matches:240, object:46, subject:194, true_class:1},
    {matches:423, object:215, subject:208, true_class:1},
    {matches:110, object:51, subject:59, true_class:1},
    {matches:56, object:8, subject:48, true_class:1},
    {matches:326, object:35, subject:291, true_class:1},
    {matches:277, object:3, subject:274, true_class:1},
    {matches:301, object:15, subject:286, true_class:1},
    {matches:459, object:240, subject:219, true_class:1},
    {matches:169, object:12, subject:157, true_class:1},
    {matches:373, object:31, subject:342, true_class:1},
    {matches:335, object:20, subject:315, true_class:1},
    {matches:385, object:194, subject:191, true_class:1},
    {matches:293, object:15, subject:278, true_class:1},
    {matches:47, object:14, subject:33, true_class:1},
    {matches:349, object:34, subject:315, true_class:1},
    {matches:237, object:155, subject:82, true_class:1},
    {matches:235, object:111, subject:124, true_class:1},
    {matches:366, object:147, subject:219, true_class:1},
    {matches:142, object:79, subject:63, true_class:1},
    {matches:66, object:51, subject:15, true_class:1},
    {matches:112, object:16, subject:96, true_class:1},
    {matches:133, object:61, subject:72, true_class:1},
    {matches:17, object:5, subject:12, true_class:1},
    {matches:60, object:8, subject:52, true_class:1},
    {matches:99, object:40, subject:59, true_class:1},
    {matches:121, object:23, subject:98, true_class:1},
    {matches:56, object:27, subject:29, true_class:1},
    {matches:55, object:35, subject:20, true_class:1},
    {matches:51, object:30, subject:21, true_class:1},
    {matches:34, object:22, subject:12, true_class:1},
    {matches:73, object:41, subject:32, true_class:1},
    {matches:123, object:73, subject:50, true_class:1},
    {matches:128, object:54, subject:74, true_class:1},
    {matches:38, object:12, subject:26, true_class:1},
    {matches:204, object:75, subject:129, true_class:1},
    {matches:271, object:98, subject:173, true_class:1},
    {matches:111, object:44, subject:67, true_class:1},
    {matches:318, object:58, subject:260, true_class:1},
    {matches:123, object:25, subject:98, true_class:1},
    {matches:100, object:20, subject:80, true_class:1},
    {matches:68, object:23, subject:45, true_class:1},
    {matches:9, object:4, subject:5, true_class:1},
    {matches:33, object:5, subject:28, true_class:1},

    {matches:79, object:0, subject:79, true_class:0},
    {matches:27, object:10, subject:17, true_class:0},
    {matches:34, object:5, subject:29, true_class:0},
    {matches:110, object:69, subject:41, true_class:0},
    {matches:131, object:92, subject:39, true_class:0},
    {matches:59, object:44, subject:15, true_class:0},
    {matches:142, object:60, subject:82, true_class:0},
    {matches:23	, object:12, subject:11, true_class:0},
    {matches:328, object:101, subject:227, true_class:0},
    {matches:2, object:0, subject:2, true_class:0},
    {matches:12, object:0, subject:12, true_class:0},
    {matches:91, object:0, subject:91, true_class:0},
    {matches:261, object:157, subject:104, true_class:0},
    {matches:58, object:22, subject:36, true_class:0},
    {matches:99, object:81, subject:18, true_class:0},
    {matches:37, object:7, subject:30, true_class:0},
    {matches:40, object:19, subject:21, true_class:0},
    {matches:47, object:4, subject:43, true_class:0},
    {matches:27, object:0, subject:27, true_class:0},
    {matches:84, object:48, subject:36, true_class:0},
    {matches:211, object:198, subject:13, true_class:0},
    {matches:112, object:1, subject:111, true_class:0},
    {matches:146, object:0, subject:146, true_class:0},
    {matches:48, object:0, subject:48, true_class:0},
    {matches:145, object:5, subject:140, true_class:0},
    {matches:64, object:0, subject:64, true_class:0},
    {matches:70, object:0, subject:70, true_class:0},
    {matches:38, object:1, subject:37, true_class:0},
    {matches:98, object:89, subject:9, true_class:0},
    {matches:179, object:35, subject:144, true_class:0},
    {matches:632, object:611, subject:21, true_class:0},
    {matches:19, object:14, subject:5, true_class:0},
    {matches:324, object:158, subject:166, true_class:0},
    {matches:121, object:0, subject:121, true_class:0},
    {matches:43, object:7, subject:36, true_class:0},
    {matches:749, object:482, subject:267, true_class:0},
    {matches:305, object:32, subject:273, true_class:0},
    {matches:52, object:35, subject:17, true_class:0},
    {matches:374, object:0, subject:374, true_class:0},
    {matches:283, object:13, subject:270, true_class:0},
    {matches:89, object:17, subject:72, true_class:0},
    {matches:59, object:2, subject:57, true_class:0},
    {matches:36, object:36, subject:0, true_class:0},
    {matches:52, object:12, subject:40, true_class:0},
    {matches:129, object:14, subject:115, true_class:0},
    {matches:35, object:28, subject:7, true_class:0},
    {matches:76, object:3, subject:73, true_class:0},
    {matches:71, object:6, subject:65, true_class:0},
    {matches:22, object:0, subject:22, true_class:0},
    {matches:41, object:13, subject:28, true_class:0},
    {matches:218, object:55, subject:163, true_class:0},
    {matches:124, object:10, subject:114, true_class:0},
    {matches:68, object:20, subject:48, true_class:0},
    {matches:64, object:13, subject:51, true_class:0},
    {matches:26, object:3, subject:23, true_class:0},
    {matches:9, object:0, subject:9, true_class:0},
    {matches:245, object:33, subject:212, true_class:0},
    {matches:63, object:61, subject:2, true_class:0},
    {matches:101, object:10, subject:91, true_class:0},
    {matches:25, object:8, subject:17, true_class:0},
    {matches:132, object:10, subject:122, true_class:0},
    {matches:48, object:27, subject:21, true_class:0},
    {matches:20, object:15, subject:5, true_class:0},
    {matches:96, object:21, subject:75, true_class:0},
    {matches:318, object:149, subject:169, true_class:0},
    {matches:14, object:3, subject:11, true_class:0},
    {matches:376, object:185, subject:191, true_class:0},
    {matches:30, object:21, subject:9, true_class:0},
    {matches:24, object:15, subject:9, true_class:0},
    {matches:30, object:3, subject:27, true_class:0},
    {matches:175, object:30, subject:145, true_class:0},
    {matches:5, object:3, subject:2, true_class:0},
    {matches:233, object:213, subject:20, true_class:0},
    {matches:52, object:1, subject:51, true_class:0},
    {matches:19, object:18, subject:1, true_class:0},
    {matches:81, object:6, subject:75, true_class:0},
    {matches:92, object:33, subject:59, true_class:0},
    {matches:302, object:79, subject:223, true_class:0},
    {matches:117, object:2, subject:115, true_class:0},
    {matches:25, object:14, subject:11, true_class:0},
    {matches:4, object:2, subject:2, true_class:0},
    {matches:5, object:2, subject:3, true_class:0},
    {matches:35, object:3, subject:32, true_class:0},
    {matches:11, object:0, subject:11, true_class:0},
    {matches:187, object:125, subject:62, true_class:0},
    {matches:95, object:56, subject:39, true_class:0},
    {matches:37, object:1, subject:36, true_class:0},
    {matches:76, object:26, subject:50, true_class:0},
    {matches:204, object:22, subject:182, true_class:0},
    {matches:104, object:2, subject:102, true_class:0},
    {matches:446, object:348, subject:98, true_class:0},
    {matches:139, object:57, subject:82, true_class:0},
    {matches:125, object:68, subject:57, true_class:0}

];

var samples = [
    {matches:20, true_class:1},
    {matches:26, true_class:1},
    {matches:4, true_class:1},
    {matches:246, true_class:1},
    {matches:2, true_class:1},
    {matches:6, true_class:1},
    {matches:50, true_class:1},
    {matches:6, true_class:1},
    {matches:0, true_class:1},
    {matches:12, true_class:1},
    {matches:0, true_class:1},
    {matches:6, true_class:1},
    {matches:24, true_class:1},
    {matches:48, true_class:1},
    {matches:0, true_class:1},
    {matches:4, true_class:1},
    {matches:0, true_class:1},
    {matches:0, true_class:1},
    {matches:18, true_class:1},
    {matches:14, true_class:1},
    {matches:2, true_class:1},
    {matches:12, true_class:1},
    {matches:30, true_class:1},
    {matches:82, true_class:1},
    {matches:86, true_class:1},
    {matches:24, true_class:1},
    {matches:54, true_class:1},
    {matches:26, true_class:1},
    {matches:36, true_class:1},
    {matches:50, true_class:1},
    {matches:14, true_class:1},
    {matches:12, true_class:1},
    {matches:0, true_class:1},
    {matches:32, true_class:1},
    {matches:20, true_class:1},
    {matches:8, true_class:1},
    {matches:10, true_class:1},
    {matches:2, true_class:1},
    {matches:26, true_class:1},
    {matches:4, true_class:1},
    {matches:6, true_class:1},
    {matches:0, true_class:1},
    {matches:8, true_class:1},
    {matches:2, true_class:1},
    {matches:62, true_class:1},
    {matches:36, true_class:1},
    {matches:50, true_class:1},
    {matches:14, true_class:1},

    {matches:0, true_class:0},
    {matches:8, true_class:0},
    {matches:4, true_class:0},
    {matches:0, true_class:0},
    {matches:12, true_class:0},
    {matches:2, true_class:0},
    {matches:14, true_class:0},
    {matches:2, true_class:0},
    {matches:36, true_class:0},
    {matches:0, true_class:0},
    {matches:0, true_class:0},
    {matches:4, true_class:0},
    {matches:28, true_class:0},
    {matches:4, true_class:0},
    {matches:0, true_class:0},
    {matches:14, true_class:0},
    {matches:10, true_class:0},
    {matches:0, true_class:0},
    {matches:0, true_class:0},
    {matches:26, true_class:0},
    {matches:6, true_class:0},
    {matches:0, true_class:0},
    {matches:6, true_class:0},
    {matches:0, true_class:0},
    {matches:6, true_class:0},
    {matches:0, true_class:0},
    {matches:0, true_class:0},
    {matches:4, true_class:0},
    {matches:2, true_class:0},
    {matches:6, true_class:0},
    {matches:0, true_class:0},
    {matches:0, true_class:0},
    {matches:36, true_class:0},
    {matches:0, true_class:0},
    {matches:10, true_class:0},
    {matches:28, true_class:0},
    {matches:6, true_class:0},
    {matches:6, true_class:0},
    {matches:0, true_class:0},
    {matches:4, true_class:0},
    {matches:8, true_class:0},
    {matches:2, true_class:0},
    {matches:4, true_class:0},
    {matches:0, true_class:0},
    {matches:8, true_class:0},
    {matches:4, true_class:0},
    {matches:2, true_class:0},
    {matches:0, true_class:0}

];

var THRESHOLD_MATCHES = 0;
var THRESHOLD_SUB_OB = 0;

function calculateFScore(alpha, results) {
    var precision = results.TP / (results.TP + results.FP);
    var recall = results.TP / (results.TP + results.FN);
    var alpha_squared = Math.pow(alpha,2);
    var F = (1 + alpha_squared) * (precision * recall) / (alpha_squared * precision + recall);
    return F;
}

function classifySamples(threshold_matches) {
    var results = {TP: 0, TN: 0, FP: 0, FN: 0};
    for(var i = 0; i < samples.length; i++) {
        var sample = samples[i];
        if(sample.matches > threshold_matches) {
            var predicted_class = 1;
        }
        else var predicted_class = 0;

        if(predicted_class === 1) {
            if (sample.true_class === 1)
                results.TP++;
            else if (sample.true_class === 0)
                results.FP++;
        }
        else if (predicted_class === 0) {
            if (sample.true_class === 1)
                results.FN++;
            else if (sample.true_class === 0)
                results.TN++;
        }
    }
    return results;
}

var UPPER_LIMIT_MATCHES = 239;
var F_score = 0;
var end_results = {TP: 0, TN: 0, FP: 100, FN: 100};
var temp_threshold_matches = 0;

for(var i = 1; i < UPPER_LIMIT_MATCHES; i++) {
    temp_threshold_matches = i;
    var results = classifySamples(temp_threshold_matches);
    var temp_F = calculateFScore(1, results);
    if (results.TP + results.TN > end_results.TP + end_results.TN) {
        F_score = temp_F;
        THRESHOLD_MATCHES = temp_threshold_matches;
        end_results = results;
    }
}

console.log("Final F1 score: " + F_score + " | " + THRESHOLD_MATCHES);
console.log("Final results: " + "TP:" + end_results.TP + " TN:" + end_results.TN + " FP:" + end_results.FP
    + " FN:" + end_results.FN);
var sum = end_results.TP + end_results.TN;
console.log("Correctly classified: " + sum + "/" + samples.length);